{
	"name": "M1L1E2 - Explore with Serverless PARQUET",
	"properties": {
		"description": "Common Lab for DP-203 and DP-500, corresponds to Module 1",
		"folder": {
			"name": "DP-203 New Labs"
		},
		"content": {
			"query": " -- This is auto-generated code\n SELECT\n     TOP 100 *\n FROM\n     OPENROWSET(\n         BULK 'https://datalake7zgdr24.dfs.core.windows.net/files/sales/parquet/**',\n         FORMAT = 'PARQUET'\n     ) AS [result]\n\n-- Note that the results include order counts for all three years - \n-- the wildcard used in the BULK path causes the query to return data from all subfolders.\n\n SELECT YEAR(OrderDate) AS OrderYear,\n        COUNT(*) AS OrderedItems\n FROM\n     OPENROWSET(\n         BULK 'https://datalake7zgdr24.dfs.core.windows.net/files/sales/parquet/**',\n         FORMAT = 'PARQUET'\n     ) AS [result]\n GROUP BY YEAR(OrderDate)\n ORDER BY OrderYear\n\n -- Review the results and note that they include only the sales counts for 2019 and 2020. \n -- This filtering is achieved by inclusing a wildcard for the partition folder value in \n -- the BULK path (year=*) and a WHERE clause based on the filepath property of the results \n -- returned by OPENROWSET (which in this case has the alias [result]).\n\n  SELECT YEAR(OrderDate) AS OrderYear,\n        COUNT(*) AS OrderedItems\n FROM\n     OPENROWSET(\n         BULK 'https://datalake7zgdr24.dfs.core.windows.net/files/sales/parquet/year=*/',\n         FORMAT = 'PARQUET'\n     ) AS [result]\n WHERE [result].filepath(1) IN ('2019', '2020')\n GROUP BY YEAR(OrderDate)\n ORDER BY OrderYear\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "master",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}